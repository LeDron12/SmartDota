2025-05-11 18:43:18,428 - root - INFO - Starting time-based CV experiment with config: configs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats.yaml
2025-05-11 18:43:18,428 - root - INFO - Number of windows: 6, Window size: 2 hours
2025-05-11 18:43:18,431 - src.experiments.src.utils.config - INFO - Loaded configuration from configs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats.yaml
2025-05-11 18:43:18,431 - src.experiments.src.utils.config - INFO - Transformer 'StarzDatasetConverter' is enabled
2025-05-11 18:43:18,431 - src.experiments.src.utils.config - INFO - Transformer 'HeroFeaturesTransformer' is disabled
2025-05-11 18:43:18,431 - src.experiments.src.utils.config - INFO - Transformer 'HeroStatsTransformer' is enabled
2025-05-11 18:43:18,431 - src.experiments.src.utils.config - INFO - Transformer 'PlayerStatsTransformer' is enabled
2025-05-11 18:43:18,431 - src.experiments.src.utils.config - INFO - Transformer 'PlayerHeroStatsTransformer' is enabled
2025-05-11 18:43:18,433 - src.experiments.src.core.dataset_factory - INFO - Loading dataset of type: starz_public_matches
2025-05-11 18:43:18,433 - src.experiments.src.core.dataset_factory - INFO - Loading starz public matches from: /Users/ankamenskiy/SmartDota/src/data_new/fetched_datasets/stratz_matches.json
2025-05-11 18:43:19,738 - src.experiments.src.core.dataset_factory - INFO - Removed 103 matches due to missing or empty data.
2025-05-11 18:43:31,361 - src.experiments.src.core.dataset_factory - INFO - Loaded 27176 matches
2025-05-11 18:43:31,361 - src.experiments.src.core.dataset_factory - INFO - No role count: {'matches': 1371, 'players': 13710}
2025-05-11 18:43:31,537 - __main__ - INFO - 
Window 1/6:
2025-05-11 18:43:31,537 - __main__ - INFO - Train period: 2025-04-04 21:00:11 to 2025-05-04 18:55:49
2025-05-11 18:43:31,537 - __main__ - INFO - Validation period: 2025-05-04 19:00:05 to 2025-05-04 20:58:49
2025-05-11 18:43:31,537 - __main__ - INFO - Train size: 27072, Validation size: 104
2025-05-11 18:43:31,656 - __main__ - INFO - 
Window 2/6:
2025-05-11 18:43:31,656 - __main__ - INFO - Train period: 2025-04-04 21:00:11 to 2025-05-04 16:57:29
2025-05-11 18:43:31,656 - __main__ - INFO - Validation period: 2025-05-04 16:59:59 to 2025-05-04 18:55:49
2025-05-11 18:43:31,656 - __main__ - INFO - Train size: 26972, Validation size: 100
2025-05-11 18:43:31,775 - __main__ - INFO - 
Window 3/6:
2025-05-11 18:43:31,776 - __main__ - INFO - Train period: 2025-04-04 21:00:11 to 2025-05-04 14:58:44
2025-05-11 18:43:31,776 - __main__ - INFO - Validation period: 2025-05-04 14:58:55 to 2025-05-04 16:57:29
2025-05-11 18:43:31,776 - __main__ - INFO - Train size: 26829, Validation size: 143
2025-05-11 18:43:31,894 - __main__ - INFO - 
Window 4/6:
2025-05-11 18:43:31,895 - __main__ - INFO - Train period: 2025-04-04 21:00:11 to 2025-05-04 12:58:24
2025-05-11 18:43:31,895 - __main__ - INFO - Validation period: 2025-05-04 12:59:30 to 2025-05-04 14:58:44
2025-05-11 18:43:31,895 - __main__ - INFO - Train size: 26674, Validation size: 155
2025-05-11 18:43:32,013 - __main__ - INFO - 
Window 5/6:
2025-05-11 18:43:32,014 - __main__ - INFO - Train period: 2025-04-04 21:00:11 to 2025-05-04 10:58:34
2025-05-11 18:43:32,014 - __main__ - INFO - Validation period: 2025-05-04 10:58:55 to 2025-05-04 12:58:24
2025-05-11 18:43:32,014 - __main__ - INFO - Train size: 26557, Validation size: 117
2025-05-11 18:43:32,136 - __main__ - INFO - 
Window 6/6:
2025-05-11 18:43:32,136 - __main__ - INFO - Train period: 2025-04-04 21:00:11 to 2025-05-04 08:58:34
2025-05-11 18:43:32,136 - __main__ - INFO - Validation period: 2025-05-04 09:01:45 to 2025-05-04 10:58:34
2025-05-11 18:43:32,136 - __main__ - INFO - Train size: 26464, Validation size: 93
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: DatasetConverter
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: StarzDatasetConverter
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: HeroFeaturesTransformer
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: HeroStatsTransformer
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: PlayerStatsTransformer
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: PlayerHeroStatsTransformer
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Registered transformer: PlayerRatingsTransformer
2025-05-11 18:43:32,138 - src.experiments.src.core.factory - INFO - Added transformer to pipeline: StarzDatasetConverter
2025-05-11 18:43:32,138 - src.experiments.src.transformers.hero_features - INFO - Loading hero mapping...
2025-05-11 18:43:32,138 - src.experiments.src.transformers.hero_features - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/heroes.json
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Loaded 126 heroes
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Sample hero: 1 -> Anti-Mage (seq_id: 0)
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Sample hero: 2 -> Axe (seq_id: 1)
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Sample hero: 3 -> Bane (seq_id: 2)
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Sample hero: 4 -> Bloodseeker (seq_id: 3)
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Sample hero: 5 -> Crystal Maiden (seq_id: 4)
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_features - INFO - Initialized 252 feature names
2025-05-11 18:43:32,139 - src.experiments.src.transformers.hero_stats_transformer - INFO - Excluding features: set()
2025-05-11 18:43:32,139 - src.experiments.src.core.factory - INFO - Added transformer to pipeline: HeroStatsTransformer
2025-05-11 18:43:32,139 - src.experiments.src.core.factory - INFO - Added transformer to pipeline: PlayerStatsTransformer
2025-05-11 18:43:32,139 - src.experiments.src.core.factory - INFO - Added transformer to pipeline: PlayerHeroStatsTransformer
2025-05-11 18:43:32,139 - root - INFO - 
Processing window 1/6
2025-05-11 18:43:32,140 - src.experiments.src.core.factory - INFO - Fitting pipeline on DataFrame with shape: (27072, 19)
2025-05-11 18:43:32,141 - src.experiments.src.core.factory - INFO - Fitting transformer: StarzDatasetConverter
2025-05-11 18:43:32,146 - src.experiments.src.core.factory - INFO - Fitting transformer: HeroStatsTransformer
2025-05-11 18:43:32,149 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:43:32,152 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loaded hero data from /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:43:32,152 - src.experiments.src.transformers.hero_stats_transformer - INFO - Number of heroes: 126
2025-05-11 18:43:32,152 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero statistics from match data...
2025-05-11 18:43:32,988 - src.experiments.src.transformers.hero_stats_transformer - INFO - Finished calculating hero statistics
2025-05-11 18:43:32,993 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerStatsTransformer
2025-05-11 18:43:32,997 - src.experiments.src.transformers.player_stats_transformer - INFO - Calculating player statistics from match data...
2025-05-11 18:43:35,422 - src.experiments.src.transformers.player_stats_transformer - INFO - Finished calculating player statistics
2025-05-11 18:43:35,431 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerHeroStatsTransformer
2025-05-11 18:43:35,434 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Calculating player-hero statistics from match data...
2025-05-11 18:43:40,224 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Finished calculating player-hero statistics
2025-05-11 18:43:40,230 - src.experiments.src.core.factory - INFO - Pipeline fitting completed
2025-05-11 18:43:40,230 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (27072, 19)
2025-05-11 18:43:40,230 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:43:40,234 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:43:40,236 - src.experiments.src.core.factory - INFO - Result df shape: (27072, 1)
2025-05-11 18:43:40,236 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:43:40,238 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   actualRank
0          62
1          62
2          71
3          72
4          54
2025-05-11 18:43:40,238 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:43:40,241 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:43:40,241 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:43:40,608 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:43:41,322 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:43:41,693 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:43:42,349 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:43:42,352 - src.experiments.src.core.factory - INFO - Result df shape: (27072, 7)
2025-05-11 18:43:42,352 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:43:42,355 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
0                   0.092738                0.090928                      0.499215               0.515670                  0.511453               0.531546                  0.500200
1                   0.105482                0.147865                      0.503574               0.504852                  0.493711               0.504720                  0.505776
2                   0.100901                0.114768                      0.496661               0.493277                  0.482454               0.497027                  0.465066
3                   0.108016                0.072791                      0.522489               0.507871                  0.511432               0.492102                  0.537615
4                   0.135867                0.091689                      0.500877               0.496680                  0.503572               0.489124                  0.508170
2025-05-11 18:43:42,355 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:43:42,360 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:44:26,596 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:44:26,606 - src.experiments.src.core.factory - INFO - Result df shape: (27072, 28)
2025-05-11 18:44:26,606 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:44:26,618 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  radiant_avg_hero_damage  ...  dire_avg_behavior  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
0           8.822222            8.716667            15.988889             225.463889            8.097222             30319.183333  ...           0.000000                    80.0                 0.4                  0.0                -1275954.2                      6.4
1           8.766667            6.200000            14.766667             154.733333           10.166667             21074.366667  ...           0.000000                    47.6                 0.2                  0.0                 -342750.0                      1.4
2          11.600000           11.000000            23.000000             308.600000            5.600000             37513.000000  ...           0.010526                    85.6                 0.0                  0.0                -2433459.2                     10.4
3           7.757143            8.723810            16.047619             262.597619            7.680952             30677.454762  ...           0.000000                   165.8                 1.0                  0.0                -2246007.6                     13.2
4          10.800000            9.400000            22.900000             189.500000            5.500000             36460.100000  ...           0.000000                    41.8                 0.6                  0.0                 -705874.2                      1.6

[5 rows x 28 columns]
2025-05-11 18:44:26,618 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:44:26,626 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:44:52,751 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:44:52,759 - src.experiments.src.core.factory - INFO - Result df shape: (27072, 12)
2025-05-11 18:44:52,760 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:44:52,766 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
0                    0.522222                         6.8                         0.233333                             1.84  ...                      0.960000                          1.08                         0.900000                             1.32
1                    0.766667                         2.0                         1.000000                             1.08  ...                      0.000000                          1.00                         0.000000                             1.00
2                    1.000000                         1.0                         1.000000                             1.00  ...                      0.111333                          2.00                         0.133333                             1.32
3                    0.552381                        11.2                         0.787238                             2.08  ...                      0.040000                          1.40                         0.086667                             1.48
4                    0.900000                         1.2                         1.000000                             1.00  ...                      0.120000                          1.24                         0.060000                             1.12

[5 rows x 12 columns]
2025-05-11 18:44:52,773 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:44:52,774 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (104, 19)
2025-05-11 18:44:52,774 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:44:52,775 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:44:52,775 - src.experiments.src.core.factory - INFO - Result df shape: (104, 1)
2025-05-11 18:44:52,775 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:44:52,776 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       actualRank
27072          52
27073          71
27074          43
27075          73
27076          73
2025-05-11 18:44:52,776 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:44:52,776 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:44:52,776 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:44:52,779 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:44:52,789 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:44:52,791 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:44:52,796 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:44:52,797 - src.experiments.src.core.factory - INFO - Result df shape: (104, 7)
2025-05-11 18:44:52,797 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:44:52,800 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
27072                   0.124527                0.073456                      0.513007               0.475549                  0.500022               0.447461                  0.503436
27073                   0.139369                0.094119                      0.500098               0.505961                  0.512237               0.479232                  0.505886
27074                   0.123966                0.122562                      0.487277               0.498771                  0.500402               0.492646                  0.493144
27075                   0.089731                0.125975                      0.486481               0.495418                  0.489690               0.482763                  0.460000
27076                   0.114849                0.102283                      0.517249               0.482762                  0.504733               0.460613                  0.496431
2025-05-11 18:44:52,800 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:44:52,800 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:44:52,986 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:44:52,986 - src.experiments.src.core.factory - INFO - Result df shape: (104, 28)
2025-05-11 18:44:52,986 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:44:52,994 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  ...  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
27072          10.000000            9.171429            17.300000             204.442857            7.350000  ...                0.000000            0.000000                  0.0                  0.000000                 0.000000
27073           8.320000            8.234035            15.115789             224.508070            9.232982  ...              121.400000            1.000000                  0.0              94954.800000                 3.400000
27074           5.000000            2.500000            20.000000             117.500000            1.000000  ...               77.500000            1.000000                  0.0              86025.000000                 5.000000
27075           8.852564            8.392308            17.498718             220.729487            8.665385  ...              134.250000            0.500000                  0.0             816821.250000                10.000000
27076          10.736111            6.480000            15.104444             306.918889            8.563333  ...               66.666667            0.666667                  0.0             459890.666667                14.333333

[5 rows x 28 columns]
2025-05-11 18:44:52,994 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:44:52,994 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:44:53,229 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:44:53,229 - src.experiments.src.core.factory - INFO - Result df shape: (104, 12)
2025-05-11 18:44:53,229 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:44:53,234 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
27072                    0.385714                         2.8                         0.500000                         1.000000  ...                      0.000000                          0.00                         0.000000                         0.000000
27073                    0.232982                         8.0                         0.344444                         1.300000  ...                      0.937500                          1.50                         0.500000                         1.000000
27074                    1.000000                         2.0                         0.000000                         0.000000  ...                      0.000000                          1.50                         1.000000                         1.000000
27075                    0.450000                         9.2                         0.266667                         1.266667  ...                      0.958333                          1.25                         0.416667                         1.000000
27076                    0.562778                        12.2                         0.562500                         1.825000  ...                      0.116667                          2.00                         0.533333                         1.266667

[5 rows x 12 columns]
2025-05-11 18:44:53,235 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:44:53,235 - src.experiments.src.core.model_trainer - INFO - Using parameter grid search: False
2025-05-11 18:44:53,235 - src.experiments.src.core.model_trainer - INFO - Using SHAP: True
2025-05-11 18:44:53,235 - src.experiments.src.core.model_trainer - INFO - Using feature scaling: False
2025-05-11 18:44:53,238 - src.experiments.src.core.model_trainer - INFO - 
Training and evaluating models...
2025-05-11 18:44:53,238 - src.experiments.src.core.model_trainer - INFO - 
Training LogisticRegression...
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - 
LogisticRegression metrics:
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.6163
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - f1: 0.6612
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - precision: 0.6250
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - recall: 0.7018
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.6058
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.7465
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2571
2025-05-11 18:44:54,279 - src.experiments.src.core.model_trainer - INFO - 
New best model: LogisticRegression (AUC-ROC: 0.6163)
2025-05-11 18:44:54,279 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for LogisticRegression
2025-05-11 18:44:57,303 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for LogisticRegression
2025-05-11 18:44:57,304 - src.experiments.src.core.model_trainer - INFO - 
Training RandomForest...
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - 
RandomForest metrics:
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5890
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - f1: 0.6126
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - precision: 0.6296
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - recall: 0.5965
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5865
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - log_loss: 1.4426
2025-05-11 18:44:59,245 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2751
2025-05-11 18:44:59,245 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for RandomForest
2025-05-11 18:45:04,357 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for RandomForest
2025-05-11 18:45:04,357 - src.experiments.src.core.model_trainer - INFO - 
Training CatBoost...
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - 
CatBoost metrics:
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.6211
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - f1: 0.6154
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - precision: 0.6809
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - recall: 0.5614
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.6154
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.7445
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2601
2025-05-11 18:45:04,897 - src.experiments.src.core.model_trainer - INFO - 
New best model: CatBoost (AUC-ROC: 0.6211)
2025-05-11 18:45:04,897 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for CatBoost
2025-05-11 18:45:05,007 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for CatBoost
2025-05-11 18:45:05,009 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_1/model_comparison.csv
2025-05-11 18:45:05,009 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_1/model_comparison.json
2025-05-11 18:45:05,009 - src.experiments.src.utils.metrics - INFO - 
Model comparison:
2025-05-11 18:45:05,011 - src.experiments.src.utils.metrics - INFO - 
                     auc_roc        f1  precision    recall  accuracy  log_loss  brier_score
LogisticRegression  0.616275  0.661157   0.625000  0.701754  0.605769  0.746545     0.257099
RandomForest        0.589026  0.612613   0.629630  0.596491  0.586538  1.442613     0.275137
CatBoost            0.621127  0.615385   0.680851  0.561404  0.615385  0.744513     0.260066
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - 
LogisticRegression optimal threshold analysis:
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.192
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.724
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Precision: 0.579
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Recall: 0.965
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.596
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.257
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.505
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.672
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Precision: 0.645
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Recall: 0.702
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.625
2025-05-11 18:45:05,335 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.257
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - 
RandomForest optimal threshold analysis:
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.010
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.709
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - Precision: 0.554
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - Recall: 0.982
2025-05-11 18:45:05,651 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.558
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.275
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.333
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.692
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - Precision: 0.616
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - Recall: 0.789
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.615
2025-05-11 18:45:05,652 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.275
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - 
CatBoost optimal threshold analysis:
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.192
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.748
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Precision: 0.611
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Recall: 0.965
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.644
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.260
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.192
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.748
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Precision: 0.611
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Recall: 0.965
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.644
2025-05-11 18:45:05,974 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.260
2025-05-11 18:45:05,975 - src.experiments.src.core.model_trainer - INFO - Saved LogisticRegression model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_1/checkpoints/window_1_logisticregression.joblib
2025-05-11 18:45:05,994 - src.experiments.src.core.model_trainer - INFO - Saved RandomForest model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_1/checkpoints/window_1_randomforest.joblib
2025-05-11 18:45:05,996 - src.experiments.src.core.model_trainer - INFO - Saved CatBoost model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_1/checkpoints/window_1_catboost.cbm
2025-05-11 18:45:05,998 - src.experiments.src.core.model_trainer - INFO - Saved best model (CatBoost) to production at /Users/ankamenskiy/SmartDota/models/catboost/window_1.cbm
2025-05-11 18:45:05,998 - root - INFO - 
Processing window 2/6
2025-05-11 18:45:05,999 - src.experiments.src.core.factory - INFO - Fitting pipeline on DataFrame with shape: (26972, 19)
2025-05-11 18:45:05,999 - src.experiments.src.core.factory - INFO - Fitting transformer: StarzDatasetConverter
2025-05-11 18:45:06,028 - src.experiments.src.core.factory - INFO - Fitting transformer: HeroStatsTransformer
2025-05-11 18:45:06,031 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:45:06,034 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loaded hero data from /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:45:06,034 - src.experiments.src.transformers.hero_stats_transformer - INFO - Number of heroes: 126
2025-05-11 18:45:06,034 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero statistics from match data...
2025-05-11 18:45:07,051 - src.experiments.src.transformers.hero_stats_transformer - INFO - Finished calculating hero statistics
2025-05-11 18:45:07,058 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerStatsTransformer
2025-05-11 18:45:07,061 - src.experiments.src.transformers.player_stats_transformer - INFO - Calculating player statistics from match data...
2025-05-11 18:45:09,844 - src.experiments.src.transformers.player_stats_transformer - INFO - Finished calculating player statistics
2025-05-11 18:45:09,849 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerHeroStatsTransformer
2025-05-11 18:45:09,853 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Calculating player-hero statistics from match data...
2025-05-11 18:45:14,962 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Finished calculating player-hero statistics
2025-05-11 18:45:14,969 - src.experiments.src.core.factory - INFO - Pipeline fitting completed
2025-05-11 18:45:14,969 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (26972, 19)
2025-05-11 18:45:14,970 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:45:14,973 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:45:14,976 - src.experiments.src.core.factory - INFO - Result df shape: (26972, 1)
2025-05-11 18:45:14,976 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:45:14,978 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   actualRank
0          62
1          62
2          71
3          72
4          54
2025-05-11 18:45:14,978 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:45:14,981 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:45:14,981 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:45:15,638 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:45:16,432 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:45:16,820 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:45:17,190 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:45:17,192 - src.experiments.src.core.factory - INFO - Result df shape: (26972, 7)
2025-05-11 18:45:17,192 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:45:17,195 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
0                   0.092793                0.090924                      0.498115               0.515930                  0.510814               0.534668                  0.499854
1                   0.105539                0.147864                      0.503584               0.504435                  0.493824               0.502275                  0.506269
2                   0.100897                0.114689                      0.496347               0.493272                  0.482493               0.497095                  0.465202
3                   0.108023                0.072787                      0.523852               0.507386                  0.511959               0.491755                  0.538174
4                   0.136015                0.091621                      0.501190               0.496803                  0.503390               0.487806                  0.507201
2025-05-11 18:45:17,195 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:45:17,198 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:46:00,788 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:46:00,804 - src.experiments.src.core.factory - INFO - Result df shape: (26972, 28)
2025-05-11 18:46:00,806 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:46:00,818 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  radiant_avg_hero_damage  ...  dire_avg_behavior  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
0           8.822222            8.716667            15.988889             225.463889            8.097222             30319.183333  ...           0.000000                    80.0                 0.4                  0.0                -1275954.2                      6.4
1           8.766667            6.200000            14.766667             154.733333           10.166667             21074.366667  ...           0.000000                    47.6                 0.2                  0.0                 -342750.0                      1.4
2          11.600000           11.000000            23.000000             308.600000            5.600000             37513.000000  ...           0.010526                    85.6                 0.0                  0.0                -2433459.2                     10.4
3           7.757143            8.723810            16.047619             262.597619            7.680952             30677.454762  ...           0.000000                   165.8                 1.0                  0.0                -2246007.6                     13.2
4          10.800000            9.400000            22.900000             189.500000            5.500000             36460.100000  ...           0.000000                    41.8                 0.6                  0.0                 -705874.2                      1.6

[5 rows x 28 columns]
2025-05-11 18:46:00,818 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:46:00,823 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:46:26,567 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:46:26,575 - src.experiments.src.core.factory - INFO - Result df shape: (26972, 12)
2025-05-11 18:46:26,575 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:46:26,581 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
0                    0.522222                         6.8                         0.233333                             1.84  ...                      0.960000                          1.08                         0.900000                             1.32
1                    0.766667                         2.0                         1.000000                             1.08  ...                      0.000000                          1.00                         0.000000                             1.00
2                    1.000000                         1.0                         1.000000                             1.00  ...                      0.111333                          2.00                         0.133333                             1.32
3                    0.552381                        11.2                         0.787238                             2.08  ...                      0.040000                          1.40                         0.086667                             1.48
4                    0.900000                         1.2                         1.000000                             1.00  ...                      0.120000                          1.24                         0.060000                             1.12

[5 rows x 12 columns]
2025-05-11 18:46:26,592 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:46:26,597 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (100, 19)
2025-05-11 18:46:26,597 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:46:26,598 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:46:26,598 - src.experiments.src.core.factory - INFO - Result df shape: (100, 1)
2025-05-11 18:46:26,598 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:46:26,599 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       actualRank
26972          72
26973          63
26974          64
26975          62
26976          74
2025-05-11 18:46:26,599 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:46:26,600 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:46:26,600 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:46:26,606 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:46:26,609 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:46:26,611 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:46:26,613 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:46:26,613 - src.experiments.src.core.factory - INFO - Result df shape: (100, 7)
2025-05-11 18:46:26,614 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:46:26,616 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
26972                   0.137387                0.110826                      0.489776               0.507274                  0.512443               0.522609                  0.510045
26973                   0.087869                0.116550                      0.480153               0.503748                  0.481667               0.519392                  0.465633
26974                   0.151068                0.127562                      0.542426               0.489226                  0.522951               0.518987                  0.566377
26975                   0.092244                0.120214                      0.512491               0.485208                  0.512598               0.478395                  0.531446
26976                   0.121237                0.094023                      0.474501               0.512384                  0.502358               0.530812                  0.526118
2025-05-11 18:46:26,616 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:46:26,616 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:46:26,791 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:46:26,791 - src.experiments.src.core.factory - INFO - Result df shape: (100, 28)
2025-05-11 18:46:26,792 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:46:26,799 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  ...  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
26972           7.645610            6.821134            18.252991             268.551671            8.781119  ...                  110.00                 1.0                  0.0                 137083.80                    12.40
26973           5.000000            9.500000             9.400000             230.200000            7.500000  ...                   21.00                 0.0                  0.0                 182980.00                     1.00
26974           6.045486            9.174653            12.515625             151.550694            6.682292  ...                  139.25                 1.0                  0.0                 378428.25                     1.75
26975           5.888095            7.094048            14.648810             174.248810            9.123810  ...                   88.20                 0.0                  0.0                1034369.80                     5.00
26976           2.636364            2.351515             3.470303              66.851515            1.163636  ...                   49.20                 0.0                  0.8                   6955.00                     6.40

[5 rows x 28 columns]
2025-05-11 18:46:26,799 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:46:26,799 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:46:26,886 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:46:26,887 - src.experiments.src.core.factory - INFO - Result df shape: (100, 12)
2025-05-11 18:46:26,887 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:46:26,891 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
26972                    0.662549                        13.4                         0.666667                         1.733333  ...                      0.365079                      3.033333                         0.629167                         1.866667
26973                    0.000000                         3.0                         0.000000                         1.000000  ...                      0.000000                      0.000000                         0.000000                         0.000000
26974                    0.421181                        10.0                         0.738148                         2.355556  ...                      1.000000                      1.000000                         0.000000                         1.000000
26975                    0.544048                        10.0                         0.817778                         1.400000  ...                      0.326885                      2.041667                         0.500000                         1.000000
26976                    0.523030                         8.0                         0.875000                         1.541667  ...                      0.172222                      2.283333                         0.475000                         1.250000

[5 rows x 12 columns]
2025-05-11 18:46:26,891 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:46:26,892 - src.experiments.src.core.model_trainer - INFO - Using parameter grid search: False
2025-05-11 18:46:26,892 - src.experiments.src.core.model_trainer - INFO - Using SHAP: True
2025-05-11 18:46:26,892 - src.experiments.src.core.model_trainer - INFO - Using feature scaling: False
2025-05-11 18:46:26,894 - src.experiments.src.core.model_trainer - INFO - 
Training and evaluating models...
2025-05-11 18:46:26,894 - src.experiments.src.core.model_trainer - INFO - 
Training LogisticRegression...
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - 
LogisticRegression metrics:
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.4602
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - f1: 0.4854
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - precision: 0.5208
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - recall: 0.4545
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.4700
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - log_loss: 1.1541
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3680
2025-05-11 18:46:27,875 - src.experiments.src.core.model_trainer - INFO - 
New best model: LogisticRegression (AUC-ROC: 0.4602)
2025-05-11 18:46:27,875 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for LogisticRegression
2025-05-11 18:46:30,250 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for LogisticRegression
2025-05-11 18:46:30,250 - src.experiments.src.core.model_trainer - INFO - 
Training RandomForest...
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - 
RandomForest metrics:
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.4606
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - f1: 0.4400
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - precision: 0.4889
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - recall: 0.4000
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.4400
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - log_loss: 2.2498
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3370
2025-05-11 18:46:32,085 - src.experiments.src.core.model_trainer - INFO - 
New best model: RandomForest (AUC-ROC: 0.4606)
2025-05-11 18:46:32,085 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for RandomForest
2025-05-11 18:46:36,666 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for RandomForest
2025-05-11 18:46:36,666 - src.experiments.src.core.model_trainer - INFO - 
Training CatBoost...
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - 
CatBoost metrics:
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5273
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - f1: 0.5849
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - precision: 0.6078
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - recall: 0.5636
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5600
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.6932
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2500
2025-05-11 18:46:36,916 - src.experiments.src.core.model_trainer - INFO - 
New best model: CatBoost (AUC-ROC: 0.5273)
2025-05-11 18:46:36,916 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for CatBoost
2025-05-11 18:46:37,139 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for CatBoost
2025-05-11 18:46:37,140 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_2/model_comparison.csv
2025-05-11 18:46:37,140 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_2/model_comparison.json
2025-05-11 18:46:37,140 - src.experiments.src.utils.metrics - INFO - 
Model comparison:
2025-05-11 18:46:37,142 - src.experiments.src.utils.metrics - INFO - 
                     auc_roc        f1  precision    recall  accuracy  log_loss  brier_score
LogisticRegression  0.460202  0.485437   0.520833  0.454545      0.47  1.154089     0.367971
RandomForest        0.460606  0.440000   0.488889  0.400000      0.44  2.249790     0.337016
CatBoost            0.527273  0.584906   0.607843  0.563636      0.56  0.693209     0.250030
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - 
LogisticRegression optimal threshold analysis:
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.000
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.710
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Precision: 0.550
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.550
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.368
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.182
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.696
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Precision: 0.588
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Recall: 0.855
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.590
2025-05-11 18:46:37,445 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.368
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - 
RandomForest optimal threshold analysis:
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.071
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.722
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Precision: 0.584
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Recall: 0.945
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.600
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.337
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.071
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.722
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Precision: 0.584
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Recall: 0.945
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.600
2025-05-11 18:46:37,748 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.337
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - 
CatBoost optimal threshold analysis:
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.465
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.716
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Precision: 0.570
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Recall: 0.964
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.580
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.250
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.465
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.716
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Precision: 0.570
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Recall: 0.964
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.580
2025-05-11 18:46:38,048 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.250
2025-05-11 18:46:38,049 - src.experiments.src.core.model_trainer - INFO - Saved LogisticRegression model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_2/checkpoints/window_2_logisticregression.joblib
2025-05-11 18:46:38,067 - src.experiments.src.core.model_trainer - INFO - Saved RandomForest model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_2/checkpoints/window_2_randomforest.joblib
2025-05-11 18:46:38,067 - src.experiments.src.core.model_trainer - INFO - Saved CatBoost model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_2/checkpoints/window_2_catboost.cbm
2025-05-11 18:46:38,069 - src.experiments.src.core.model_trainer - INFO - Saved best model (CatBoost) to production at /Users/ankamenskiy/SmartDota/models/catboost/window_2.cbm
2025-05-11 18:46:38,069 - root - INFO - 
Processing window 3/6
2025-05-11 18:46:38,070 - src.experiments.src.core.factory - INFO - Fitting pipeline on DataFrame with shape: (26829, 19)
2025-05-11 18:46:38,070 - src.experiments.src.core.factory - INFO - Fitting transformer: StarzDatasetConverter
2025-05-11 18:46:38,078 - src.experiments.src.core.factory - INFO - Fitting transformer: HeroStatsTransformer
2025-05-11 18:46:38,082 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:46:38,084 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loaded hero data from /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:46:38,084 - src.experiments.src.transformers.hero_stats_transformer - INFO - Number of heroes: 126
2025-05-11 18:46:38,084 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero statistics from match data...
2025-05-11 18:46:38,903 - src.experiments.src.transformers.hero_stats_transformer - INFO - Finished calculating hero statistics
2025-05-11 18:46:38,908 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerStatsTransformer
2025-05-11 18:46:38,911 - src.experiments.src.transformers.player_stats_transformer - INFO - Calculating player statistics from match data...
2025-05-11 18:46:41,584 - src.experiments.src.transformers.player_stats_transformer - INFO - Finished calculating player statistics
2025-05-11 18:46:41,591 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerHeroStatsTransformer
2025-05-11 18:46:41,595 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Calculating player-hero statistics from match data...
2025-05-11 18:46:46,462 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Finished calculating player-hero statistics
2025-05-11 18:46:46,467 - src.experiments.src.core.factory - INFO - Pipeline fitting completed
2025-05-11 18:46:46,467 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (26829, 19)
2025-05-11 18:46:46,467 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:46:46,471 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:46:46,475 - src.experiments.src.core.factory - INFO - Result df shape: (26829, 1)
2025-05-11 18:46:46,475 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:46:46,477 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   actualRank
0          62
1          62
2          71
3          72
4          54
2025-05-11 18:46:46,477 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:46:46,480 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:46:46,480 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:46:47,084 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:46:47,769 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:46:48,139 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:46:48,581 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:46:48,584 - src.experiments.src.core.factory - INFO - Result df shape: (26829, 7)
2025-05-11 18:46:48,584 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:46:48,587 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
0                   0.092803                0.090917                      0.498215               0.516101                  0.510881               0.535316                  0.501433
1                   0.105580                0.147922                      0.503844               0.504795                  0.493648               0.500733                  0.506832
2                   0.100809                0.114682                      0.497494               0.492634                  0.482381               0.494305                  0.466192
3                   0.108099                0.072727                      0.524139               0.506995                  0.511411               0.492335                  0.536511
4                   0.136069                0.091692                      0.501296               0.497403                  0.503387               0.488792                  0.507958
2025-05-11 18:46:48,587 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:46:48,590 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:47:31,126 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:47:31,135 - src.experiments.src.core.factory - INFO - Result df shape: (26829, 28)
2025-05-11 18:47:31,136 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:47:31,151 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  radiant_avg_hero_damage  ...  dire_avg_behavior  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
0           8.822222            8.716667            15.988889             225.463889            8.097222             30319.183333  ...           0.000000                    80.0                 0.4                  0.0                -1275954.2                      6.4
1           8.766667            6.200000            14.766667             154.733333           10.166667             21074.366667  ...           0.000000                    47.6                 0.2                  0.0                 -342750.0                      1.4
2          11.600000           11.000000            23.000000             308.600000            5.600000             37513.000000  ...           0.010526                    85.6                 0.0                  0.0                -2433459.2                     10.4
3           7.757143            8.723810            16.047619             262.597619            7.680952             30677.454762  ...           0.000000                   165.8                 1.0                  0.0                -2246007.6                     13.2
4          10.800000            9.400000            22.900000             189.500000            5.500000             36460.100000  ...           0.000000                    41.8                 0.6                  0.0                 -705874.2                      1.6

[5 rows x 28 columns]
2025-05-11 18:47:31,151 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:47:31,156 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:47:57,288 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:47:57,296 - src.experiments.src.core.factory - INFO - Result df shape: (26829, 12)
2025-05-11 18:47:57,297 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:47:57,304 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
0                    0.522222                         6.8                         0.233333                             1.84  ...                      0.960000                          1.08                         0.900000                             1.32
1                    0.766667                         2.0                         1.000000                             1.08  ...                      0.000000                          1.00                         0.000000                             1.00
2                    1.000000                         1.0                         1.000000                             1.00  ...                      0.111333                          2.00                         0.133333                             1.32
3                    0.552381                        11.2                         0.787238                             2.08  ...                      0.040000                          1.40                         0.086667                             1.48
4                    0.900000                         1.2                         1.000000                             1.00  ...                      0.120000                          1.24                         0.060000                             1.12

[5 rows x 12 columns]
2025-05-11 18:47:57,310 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:47:57,313 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (143, 19)
2025-05-11 18:47:57,313 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:47:57,313 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:47:57,313 - src.experiments.src.core.factory - INFO - Result df shape: (143, 1)
2025-05-11 18:47:57,313 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:47:57,314 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       actualRank
26829          62
26830          54
26831          50
26832          54
26833          63
2025-05-11 18:47:57,314 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:47:57,314 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:47:57,314 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:47:57,318 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:47:57,322 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:47:57,325 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:47:57,328 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:47:57,328 - src.experiments.src.core.factory - INFO - Result df shape: (143, 7)
2025-05-11 18:47:57,328 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:47:57,330 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
26829                   0.115241                0.173909                      0.469782               0.509900                  0.483736               0.534879                  0.471820
26830                   0.113966                0.134854                      0.471676               0.517211                  0.494312               0.516895                  0.495955
26831                   0.124954                0.092624                      0.498541               0.495804                  0.497327               0.479918                  0.503682
26832                   0.151120                0.117887                      0.516859               0.481983                  0.497350               0.460247                  0.515555
26833                   0.118282                0.105789                      0.519181               0.486599                  0.499325               0.504906                  0.508712
2025-05-11 18:47:57,330 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:47:57,331 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:47:57,598 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:47:57,598 - src.experiments.src.core.factory - INFO - Result df shape: (143, 28)
2025-05-11 18:47:57,598 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:47:57,606 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  ...  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
26829           4.250000            4.812500            11.562500             174.750000            7.687500  ...              110.400000            0.200000                  0.0                  508793.0                 5.000000
26830           9.857143            8.952381            15.761905             159.000000            8.523810  ...               71.666667            0.333333                  0.0                 1551445.0                 1.666667
26831           0.000000            0.000000             0.000000               0.000000            0.000000  ...                0.000000            0.000000                  0.0                       0.0                 0.000000
26832           6.255921            7.263942            14.334034             237.417876            7.251337  ...              105.750000            0.250000                  0.0                 1281698.0                 4.750000
26833           0.000000            0.000000             0.000000               0.000000            0.000000  ...              108.500000            0.500000                  0.0                  576672.5                 7.500000

[5 rows x 28 columns]
2025-05-11 18:47:57,606 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:47:57,606 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:47:57,732 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:47:57,733 - src.experiments.src.core.factory - INFO - Result df shape: (143, 12)
2025-05-11 18:47:57,733 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:47:57,737 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
26829                    0.375000                        1.75                         1.000000                         1.000000  ...                      0.055556                      1.333333                         0.000000                         1.166667
26830                    0.238095                        3.00                         0.833333                         3.500000  ...                      0.000000                      1.000000                         0.000000                         0.000000
26831                    0.000000                        0.00                         0.000000                         0.000000  ...                      0.000000                      0.000000                         0.000000                         0.000000
26832                    0.556150                       10.50                         0.375000                         1.666667  ...                      0.916667                      1.000000                         0.895833                         1.208333
26833                    0.000000                        0.00                         0.000000                         0.000000  ...                      0.250000                      1.291667                         0.583333                         1.250000

[5 rows x 12 columns]
2025-05-11 18:47:57,738 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:47:57,738 - src.experiments.src.core.model_trainer - INFO - Using parameter grid search: False
2025-05-11 18:47:57,738 - src.experiments.src.core.model_trainer - INFO - Using SHAP: True
2025-05-11 18:47:57,738 - src.experiments.src.core.model_trainer - INFO - Using feature scaling: False
2025-05-11 18:47:57,740 - src.experiments.src.core.model_trainer - INFO - 
Training and evaluating models...
2025-05-11 18:47:57,740 - src.experiments.src.core.model_trainer - INFO - 
Training LogisticRegression...
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - 
LogisticRegression metrics:
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.4621
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - f1: 0.5223
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - precision: 0.5325
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - recall: 0.5125
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.4755
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - log_loss: 1.1641
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3510
2025-05-11 18:47:58,685 - src.experiments.src.core.model_trainer - INFO - 
New best model: LogisticRegression (AUC-ROC: 0.4621)
2025-05-11 18:47:58,685 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for LogisticRegression
2025-05-11 18:48:02,092 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for LogisticRegression
2025-05-11 18:48:02,092 - src.experiments.src.core.model_trainer - INFO - 
Training RandomForest...
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - 
RandomForest metrics:
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5732
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - f1: 0.5733
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - precision: 0.6143
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - recall: 0.5375
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5524
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - log_loss: 3.3851
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2916
2025-05-11 18:48:03,919 - src.experiments.src.core.model_trainer - INFO - 
New best model: RandomForest (AUC-ROC: 0.5732)
2025-05-11 18:48:03,919 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for RandomForest
2025-05-11 18:48:10,558 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for RandomForest
2025-05-11 18:48:10,558 - src.experiments.src.core.model_trainer - INFO - 
Training CatBoost...
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - 
CatBoost metrics:
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5500
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - f1: 0.5532
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - precision: 0.6393
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - recall: 0.4875
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5594
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.7005
2025-05-11 18:48:10,839 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2533
2025-05-11 18:48:10,839 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for CatBoost
2025-05-11 18:48:10,943 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for CatBoost
2025-05-11 18:48:10,945 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_3/model_comparison.csv
2025-05-11 18:48:10,945 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_3/model_comparison.json
2025-05-11 18:48:10,945 - src.experiments.src.utils.metrics - INFO - 
Model comparison:
2025-05-11 18:48:10,947 - src.experiments.src.utils.metrics - INFO - 
                     auc_roc        f1  precision  recall  accuracy  log_loss  brier_score
LogisticRegression  0.462103  0.522293   0.532468  0.5125  0.475524  1.164088     0.350959
RandomForest        0.573214  0.573333   0.614286  0.5375  0.552448  3.385140     0.291586
CatBoost            0.550000  0.553191   0.639344  0.4875  0.559441  0.700473     0.253334
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - 
LogisticRegression optimal threshold analysis:
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.030
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.721
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Precision: 0.563
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.566
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.351
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.030
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.721
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Precision: 0.563
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.566
2025-05-11 18:48:11,251 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.351
2025-05-11 18:48:11,562 - src.experiments.src.utils.metrics - INFO - 
RandomForest optimal threshold analysis:
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.061
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.724
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Precision: 0.585
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Recall: 0.950
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.594
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.292
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.313
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.685
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Precision: 0.614
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Recall: 0.775
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.601
2025-05-11 18:48:11,563 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.292
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - 
CatBoost optimal threshold analysis:
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.323
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.718
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Precision: 0.564
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Recall: 0.988
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.566
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.253
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.404
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:48:11,893 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.698
2025-05-11 18:48:11,894 - src.experiments.src.utils.metrics - INFO - Precision: 0.598
2025-05-11 18:48:11,894 - src.experiments.src.utils.metrics - INFO - Recall: 0.838
2025-05-11 18:48:11,894 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.594
2025-05-11 18:48:11,894 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.253
2025-05-11 18:48:11,894 - src.experiments.src.core.model_trainer - INFO - Saved LogisticRegression model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_3/checkpoints/window_3_logisticregression.joblib
2025-05-11 18:48:11,912 - src.experiments.src.core.model_trainer - INFO - Saved RandomForest model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_3/checkpoints/window_3_randomforest.joblib
2025-05-11 18:48:11,912 - src.experiments.src.core.model_trainer - INFO - Saved CatBoost model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_3/checkpoints/window_3_catboost.cbm
2025-05-11 18:48:11,930 - src.experiments.src.core.model_trainer - INFO - Saved best model (RandomForest) to production at /Users/ankamenskiy/SmartDota/models/sklearn/window_3.joblib
2025-05-11 18:48:11,930 - root - INFO - 
Processing window 4/6
2025-05-11 18:48:11,931 - src.experiments.src.core.factory - INFO - Fitting pipeline on DataFrame with shape: (26674, 19)
2025-05-11 18:48:11,931 - src.experiments.src.core.factory - INFO - Fitting transformer: StarzDatasetConverter
2025-05-11 18:48:11,960 - src.experiments.src.core.factory - INFO - Fitting transformer: HeroStatsTransformer
2025-05-11 18:48:11,963 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:48:11,967 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loaded hero data from /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:48:11,967 - src.experiments.src.transformers.hero_stats_transformer - INFO - Number of heroes: 126
2025-05-11 18:48:11,967 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero statistics from match data...
2025-05-11 18:48:12,918 - src.experiments.src.transformers.hero_stats_transformer - INFO - Finished calculating hero statistics
2025-05-11 18:48:12,923 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerStatsTransformer
2025-05-11 18:48:12,927 - src.experiments.src.transformers.player_stats_transformer - INFO - Calculating player statistics from match data...
2025-05-11 18:48:15,666 - src.experiments.src.transformers.player_stats_transformer - INFO - Finished calculating player statistics
2025-05-11 18:48:15,671 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerHeroStatsTransformer
2025-05-11 18:48:15,675 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Calculating player-hero statistics from match data...
2025-05-11 18:48:20,902 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Finished calculating player-hero statistics
2025-05-11 18:48:20,910 - src.experiments.src.core.factory - INFO - Pipeline fitting completed
2025-05-11 18:48:20,910 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (26674, 19)
2025-05-11 18:48:20,910 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:48:20,916 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:48:20,924 - src.experiments.src.core.factory - INFO - Result df shape: (26674, 1)
2025-05-11 18:48:20,925 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:48:20,931 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   actualRank
0          62
1          62
2          71
3          72
4          54
2025-05-11 18:48:20,932 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:48:20,935 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:48:20,935 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:48:21,570 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:48:22,329 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:48:22,707 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:48:23,070 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:48:23,073 - src.experiments.src.core.factory - INFO - Result df shape: (26674, 7)
2025-05-11 18:48:23,073 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:48:23,075 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
0                   0.092802                0.090980                      0.500221               0.515475                  0.511238               0.534166                  0.502851
1                   0.105616                0.147979                      0.503332               0.504302                  0.493653               0.500072                  0.505524
2                   0.100772                0.114696                      0.497806               0.492872                  0.482873               0.494674                  0.467762
3                   0.108135                0.072760                      0.523959               0.507262                  0.511293               0.493943                  0.534824
4                   0.136005                0.091820                      0.502448               0.496292                  0.503826               0.486493                  0.509494
2025-05-11 18:48:23,075 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:48:23,079 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:49:05,595 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:49:05,606 - src.experiments.src.core.factory - INFO - Result df shape: (26674, 28)
2025-05-11 18:49:05,606 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:49:05,617 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  radiant_avg_hero_damage  ...  dire_avg_behavior  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
0           8.822222            8.716667            15.988889             225.463889            8.097222             30319.183333  ...           0.000000                    80.0                 0.4                  0.0                -1275954.2                      6.4
1           8.766667            6.200000            14.766667             154.733333           10.166667             21074.366667  ...           0.000000                    47.6                 0.2                  0.0                 -342750.0                      1.4
2          11.600000           11.000000            23.000000             308.600000            5.600000             37513.000000  ...           0.010526                    85.6                 0.0                  0.0                -2433459.2                     10.4
3           7.757143            8.723810            16.047619             262.597619            7.680952             30677.454762  ...           0.000000                   165.8                 1.0                  0.0                -2246007.6                     13.2
4          10.800000            9.400000            22.900000             189.500000            5.500000             36460.100000  ...           0.000000                    41.8                 0.6                  0.0                 -705874.2                      1.6

[5 rows x 28 columns]
2025-05-11 18:49:05,618 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:49:05,622 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:49:30,679 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:49:30,685 - src.experiments.src.core.factory - INFO - Result df shape: (26674, 12)
2025-05-11 18:49:30,685 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:49:30,696 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
0                    0.522222                         6.8                         0.233333                             1.84  ...                      0.960000                          1.08                         0.900000                             1.32
1                    0.766667                         2.0                         1.000000                             1.08  ...                      0.000000                          1.00                         0.000000                             1.00
2                    1.000000                         1.0                         1.000000                             1.00  ...                      0.111333                          2.00                         0.133333                             1.32
3                    0.552381                        11.2                         0.787238                             2.08  ...                      0.040000                          1.40                         0.086667                             1.48
4                    0.900000                         1.2                         1.000000                             1.00  ...                      0.120000                          1.24                         0.060000                             1.12

[5 rows x 12 columns]
2025-05-11 18:49:30,713 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:49:30,717 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (155, 19)
2025-05-11 18:49:30,717 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:49:30,718 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:49:30,718 - src.experiments.src.core.factory - INFO - Result df shape: (155, 1)
2025-05-11 18:49:30,718 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:49:30,720 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       actualRank
26674          63
26675          70
26676          74
26677          80
26678          71
2025-05-11 18:49:30,720 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:49:30,720 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:49:30,720 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:49:30,728 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:49:30,742 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:49:30,746 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:49:30,748 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:49:30,749 - src.experiments.src.core.factory - INFO - Result df shape: (155, 7)
2025-05-11 18:49:30,749 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:49:30,751 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
26674                   0.092090                0.090823                      0.500476               0.501116                  0.508803               0.457382                  0.514327
26675                   0.075369                0.072190                      0.503316               0.494189                  0.485394               0.511579                  0.454628
26676                   0.116968                0.088311                      0.525069               0.483566                  0.503802               0.457627                  0.508619
26677                   0.092997                0.108315                      0.515576               0.491259                  0.500409               0.505443                  0.496304
26678                   0.111472                0.094796                      0.491349               0.510966                  0.499845               0.538277                  0.476142
2025-05-11 18:49:30,751 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:49:30,751 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:49:31,013 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:49:31,013 - src.experiments.src.core.factory - INFO - Result df shape: (155, 28)
2025-05-11 18:49:31,013 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:49:31,021 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  ...  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
26674           7.023333            6.566667            14.573333             212.303333            7.866667  ...                   107.5                 0.0                  0.0                   5882.25                      3.5
26675           5.833333            6.166667             9.833333             307.500000            8.166667  ...                     1.0                 0.0                  2.0                 871641.00                      1.0
26676           8.333016            7.008698            13.518540             274.640063           10.849397  ...                   105.8                 0.4                  0.0                 529347.60                     15.6
26677           7.710909            7.549091            15.215455             190.126364            5.820000  ...                    87.6                 0.4                  0.0                 230298.00                     20.8
26678           7.358631           10.639881            15.113095             202.961310            6.967262  ...                   144.0                 0.0                  0.0                 125442.60                     12.6

[5 rows x 28 columns]
2025-05-11 18:49:31,021 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:49:31,021 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:49:31,156 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:49:31,156 - src.experiments.src.core.factory - INFO - Result df shape: (155, 12)
2025-05-11 18:49:31,156 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:49:31,160 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
26674                    0.636667                    7.200000                         0.785714                         7.500000  ...                      1.000000                      1.500000                         1.000000                         1.250000
26675                    0.333333                    1.333333                         0.000000                         0.000000  ...                      0.000000                      0.000000                         0.000000                         0.000000
26676                    0.645397                   11.400000                         0.562500                         2.562500  ...                      0.441667                      1.708333                         0.227778                         1.833333
26677                    0.449091                   12.000000                         0.203704                         2.750000  ...                      0.436667                      2.033333                         0.686667                         1.966667
26678                    0.169643                    5.000000                         0.333333                         1.111111  ...                      0.173810                      2.366667                         0.604167                         1.270833

[5 rows x 12 columns]
2025-05-11 18:49:31,161 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:49:31,161 - src.experiments.src.core.model_trainer - INFO - Using parameter grid search: False
2025-05-11 18:49:31,161 - src.experiments.src.core.model_trainer - INFO - Using SHAP: True
2025-05-11 18:49:31,161 - src.experiments.src.core.model_trainer - INFO - Using feature scaling: False
2025-05-11 18:49:31,163 - src.experiments.src.core.model_trainer - INFO - 
Training and evaluating models...
2025-05-11 18:49:31,164 - src.experiments.src.core.model_trainer - INFO - 
Training LogisticRegression...
2025-05-11 18:49:32,095 - src.experiments.src.core.model_trainer - INFO - 
LogisticRegression metrics:
2025-05-11 18:49:32,095 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5354
2025-05-11 18:49:32,095 - src.experiments.src.core.model_trainer - INFO - f1: 0.6567
2025-05-11 18:49:32,095 - src.experiments.src.core.model_trainer - INFO - precision: 0.5546
2025-05-11 18:49:32,095 - src.experiments.src.core.model_trainer - INFO - recall: 0.8049
2025-05-11 18:49:32,096 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5548
2025-05-11 18:49:32,096 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.8929
2025-05-11 18:49:32,096 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3033
2025-05-11 18:49:32,096 - src.experiments.src.core.model_trainer - INFO - 
New best model: LogisticRegression (AUC-ROC: 0.5354)
2025-05-11 18:49:32,096 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for LogisticRegression
2025-05-11 18:49:35,728 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for LogisticRegression
2025-05-11 18:49:35,728 - src.experiments.src.core.model_trainer - INFO - 
Training RandomForest...
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - 
RandomForest metrics:
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5455
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - f1: 0.5647
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - precision: 0.5455
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - recall: 0.5854
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5226
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - log_loss: 2.0858
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2912
2025-05-11 18:49:37,554 - src.experiments.src.core.model_trainer - INFO - 
New best model: RandomForest (AUC-ROC: 0.5455)
2025-05-11 18:49:37,554 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for RandomForest
2025-05-11 18:49:44,654 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for RandomForest
2025-05-11 18:49:44,654 - src.experiments.src.core.model_trainer - INFO - 
Training CatBoost...
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - 
CatBoost metrics:
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.6019
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - f1: 0.5752
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - precision: 0.6197
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - recall: 0.5366
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5806
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.6816
2025-05-11 18:49:44,931 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2442
2025-05-11 18:49:44,932 - src.experiments.src.core.model_trainer - INFO - 
New best model: CatBoost (AUC-ROC: 0.6019)
2025-05-11 18:49:44,932 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for CatBoost
2025-05-11 18:49:45,156 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for CatBoost
2025-05-11 18:49:45,157 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_4/model_comparison.csv
2025-05-11 18:49:45,157 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_4/model_comparison.json
2025-05-11 18:49:45,157 - src.experiments.src.utils.metrics - INFO - 
Model comparison:
2025-05-11 18:49:45,159 - src.experiments.src.utils.metrics - INFO - 
                     auc_roc        f1  precision    recall  accuracy  log_loss  brier_score
LogisticRegression  0.535416  0.656716   0.554622  0.804878  0.554839  0.892937     0.303283
RandomForest        0.545523  0.564706   0.545455  0.585366  0.522581  2.085771     0.291232
CatBoost            0.601904  0.575163   0.619718  0.536585  0.580645  0.681590     0.244238
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - 
LogisticRegression optimal threshold analysis:
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.101
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.707
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Precision: 0.551
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Recall: 0.988
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.568
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.303
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.545
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.670
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Precision: 0.574
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Recall: 0.805
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.581
2025-05-11 18:49:45,462 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.303
2025-05-11 18:49:45,772 - src.experiments.src.utils.metrics - INFO - 
RandomForest optimal threshold analysis:
2025-05-11 18:49:45,772 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.071
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.696
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Precision: 0.549
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Recall: 0.951
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.561
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.291
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.071
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.696
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Precision: 0.549
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Recall: 0.951
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.561
2025-05-11 18:49:45,773 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.291
2025-05-11 18:49:46,076 - src.experiments.src.utils.metrics - INFO - 
CatBoost optimal threshold analysis:
2025-05-11 18:49:46,076 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.293
2025-05-11 18:49:46,076 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:49:46,076 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.707
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Precision: 0.547
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.561
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.244
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.434
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.656
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Precision: 0.587
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Recall: 0.744
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.587
2025-05-11 18:49:46,077 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.244
2025-05-11 18:49:46,077 - src.experiments.src.core.model_trainer - INFO - Saved LogisticRegression model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_4/checkpoints/window_4_logisticregression.joblib
2025-05-11 18:49:46,094 - src.experiments.src.core.model_trainer - INFO - Saved RandomForest model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_4/checkpoints/window_4_randomforest.joblib
2025-05-11 18:49:46,094 - src.experiments.src.core.model_trainer - INFO - Saved CatBoost model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_4/checkpoints/window_4_catboost.cbm
2025-05-11 18:49:46,096 - src.experiments.src.core.model_trainer - INFO - Saved best model (CatBoost) to production at /Users/ankamenskiy/SmartDota/models/catboost/window_4.cbm
2025-05-11 18:49:46,096 - root - INFO - 
Processing window 5/6
2025-05-11 18:49:46,097 - src.experiments.src.core.factory - INFO - Fitting pipeline on DataFrame with shape: (26557, 19)
2025-05-11 18:49:46,097 - src.experiments.src.core.factory - INFO - Fitting transformer: StarzDatasetConverter
2025-05-11 18:49:46,120 - src.experiments.src.core.factory - INFO - Fitting transformer: HeroStatsTransformer
2025-05-11 18:49:46,124 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:49:46,126 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loaded hero data from /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:49:46,126 - src.experiments.src.transformers.hero_stats_transformer - INFO - Number of heroes: 126
2025-05-11 18:49:46,126 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero statistics from match data...
2025-05-11 18:49:46,943 - src.experiments.src.transformers.hero_stats_transformer - INFO - Finished calculating hero statistics
2025-05-11 18:49:46,948 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerStatsTransformer
2025-05-11 18:49:46,951 - src.experiments.src.transformers.player_stats_transformer - INFO - Calculating player statistics from match data...
2025-05-11 18:49:49,439 - src.experiments.src.transformers.player_stats_transformer - INFO - Finished calculating player statistics
2025-05-11 18:49:49,445 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerHeroStatsTransformer
2025-05-11 18:49:49,448 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Calculating player-hero statistics from match data...
2025-05-11 18:49:54,031 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Finished calculating player-hero statistics
2025-05-11 18:49:54,036 - src.experiments.src.core.factory - INFO - Pipeline fitting completed
2025-05-11 18:49:54,037 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (26557, 19)
2025-05-11 18:49:54,037 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:49:54,040 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:49:54,043 - src.experiments.src.core.factory - INFO - Result df shape: (26557, 1)
2025-05-11 18:49:54,043 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:49:54,045 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   actualRank
0          62
1          62
2          71
3          72
4          54
2025-05-11 18:49:54,045 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:49:54,048 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:49:54,048 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:49:54,632 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:49:55,299 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:49:55,651 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:49:56,096 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:49:56,098 - src.experiments.src.core.factory - INFO - Result df shape: (26557, 7)
2025-05-11 18:49:56,099 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:49:56,101 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
0                   0.092797                0.090959                      0.500527               0.515014                  0.510907               0.534462                  0.503741
1                   0.105705                0.147953                      0.502786               0.504683                  0.493282               0.500592                  0.505661
2                   0.100757                0.114712                      0.499085               0.492597                  0.483007               0.493010                  0.466967
3                   0.108062                0.072696                      0.525906               0.507543                  0.511544               0.496963                  0.535592
4                   0.136055                0.091878                      0.503083               0.496108                  0.503874               0.486162                  0.508886
2025-05-11 18:49:56,101 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:49:56,105 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:50:37,404 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:50:37,415 - src.experiments.src.core.factory - INFO - Result df shape: (26557, 28)
2025-05-11 18:50:37,416 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:50:37,431 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  radiant_avg_hero_damage  ...  dire_avg_behavior  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
0           8.822222            8.716667            15.988889             225.463889            8.097222             30319.183333  ...           0.000000                    80.0                 0.4                  0.0                -1275954.2                      6.4
1           8.766667            6.200000            14.766667             154.733333           10.166667             21074.366667  ...           0.000000                    47.6                 0.2                  0.0                 -342750.0                      1.4
2          11.600000           11.000000            23.000000             308.600000            5.600000             37513.000000  ...           0.010526                    85.6                 0.0                  0.0                -2433459.2                     10.4
3           7.757143            8.723810            16.047619             262.597619            7.680952             30677.454762  ...           0.000000                   165.8                 1.0                  0.0                -2246007.6                     13.2
4          10.800000            9.400000            22.900000             189.500000            5.500000             36460.100000  ...           0.000000                    41.8                 0.6                  0.0                 -705874.2                      1.6

[5 rows x 28 columns]
2025-05-11 18:50:37,432 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:50:37,445 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:51:02,454 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:51:02,461 - src.experiments.src.core.factory - INFO - Result df shape: (26557, 12)
2025-05-11 18:51:02,462 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:51:02,468 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
0                    0.522222                         6.8                         0.233333                             1.84  ...                      0.960000                          1.08                         0.900000                             1.32
1                    0.766667                         2.0                         1.000000                             1.08  ...                      0.000000                          1.00                         0.000000                             1.00
2                    1.000000                         1.0                         1.000000                             1.00  ...                      0.111333                          2.00                         0.133333                             1.32
3                    0.552381                        11.2                         0.787238                             2.08  ...                      0.040000                          1.40                         0.086667                             1.48
4                    0.900000                         1.2                         1.000000                             1.00  ...                      0.120000                          1.24                         0.060000                             1.12

[5 rows x 12 columns]
2025-05-11 18:51:02,490 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:51:02,497 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (117, 19)
2025-05-11 18:51:02,497 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:51:02,498 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:51:02,499 - src.experiments.src.core.factory - INFO - Result df shape: (117, 1)
2025-05-11 18:51:02,499 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:51:02,501 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       actualRank
26557          53
26558          54
26559          71
26560          60
26561          63
2025-05-11 18:51:02,501 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:51:02,501 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:51:02,501 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:51:02,510 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:51:02,516 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:51:02,524 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:51:02,527 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:51:02,528 - src.experiments.src.core.factory - INFO - Result df shape: (117, 7)
2025-05-11 18:51:02,528 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:51:02,548 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
26557                   0.082426                0.138743                      0.451503               0.518224                  0.475646               0.542467                  0.396885
26558                   0.084836                0.126980                      0.497125               0.501089                  0.484244               0.510253                  0.455890
26559                   0.125225                0.113386                      0.534954               0.485298                  0.519659               0.480448                  0.565858
26560                   0.114373                0.141206                      0.512668               0.492225                  0.503656               0.499108                  0.512220
26561                   0.130451                0.063283                      0.513388               0.498764                  0.525450               0.489535                  0.531163
2025-05-11 18:51:02,549 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:51:02,550 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:51:02,757 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:51:02,757 - src.experiments.src.core.factory - INFO - Result df shape: (117, 28)
2025-05-11 18:51:02,757 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:51:02,765 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  ...  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
26557           8.745758            6.889091            17.934167             201.320758            6.056061  ...                    88.0                 1.0                  0.0                1329406.50                      1.5
26558           1.000000            2.000000            15.000000              80.000000            5.000000  ...                     5.0                 0.0                  0.0                1524342.00                      1.0
26559           5.322222            6.034921            10.149206             271.033333            8.539683  ...                    89.0                 0.6                  0.0                 266884.80                      6.2
26560           6.475000            6.750000            19.358333             167.375000            6.016667  ...                   104.2                 0.6                  0.0                 316827.40                      3.6
26561           6.504242            7.014949            19.576364             158.261212            5.426667  ...                    69.0                 0.5                  0.0                 202864.25                     13.0

[5 rows x 28 columns]
2025-05-11 18:51:02,766 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:51:02,766 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:51:02,870 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:51:02,870 - src.experiments.src.core.factory - INFO - Result df shape: (117, 12)
2025-05-11 18:51:02,870 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:51:02,874 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
26557                    0.752121                        10.2                         0.811111                         2.766667  ...                      0.000000                      0.000000                         0.000000                         0.000000
26558                    1.000000                         1.0                         1.000000                         1.000000  ...                      0.000000                      1.000000                         0.000000                         0.000000
26559                    0.342857                         4.8                         0.125000                         1.000000  ...                      0.366667                      1.000000                         0.300000                         1.133333
26560                    0.791667                         4.6                         1.000000                         2.000000  ...                      0.375000                      1.000000                         0.000000                         1.000000
26561                    0.735758                         9.0                         0.562222                         1.700000  ...                      0.763889                      1.166667                         0.347222                         1.500000

[5 rows x 12 columns]
2025-05-11 18:51:02,875 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:51:02,875 - src.experiments.src.core.model_trainer - INFO - Using parameter grid search: False
2025-05-11 18:51:02,875 - src.experiments.src.core.model_trainer - INFO - Using SHAP: True
2025-05-11 18:51:02,876 - src.experiments.src.core.model_trainer - INFO - Using feature scaling: False
2025-05-11 18:51:02,877 - src.experiments.src.core.model_trainer - INFO - 
Training and evaluating models...
2025-05-11 18:51:02,877 - src.experiments.src.core.model_trainer - INFO - 
Training LogisticRegression...
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - 
LogisticRegression metrics:
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.4997
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - f1: 0.5755
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - precision: 0.5000
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - recall: 0.6780
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.4957
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - log_loss: 1.0562
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3398
2025-05-11 18:51:03,825 - src.experiments.src.core.model_trainer - INFO - 
New best model: LogisticRegression (AUC-ROC: 0.4997)
2025-05-11 18:51:03,825 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for LogisticRegression
2025-05-11 18:51:06,686 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for LogisticRegression
2025-05-11 18:51:06,686 - src.experiments.src.core.model_trainer - INFO - 
Training RandomForest...
2025-05-11 18:51:08,499 - src.experiments.src.core.model_trainer - INFO - 
RandomForest metrics:
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5373
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - f1: 0.5528
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - precision: 0.5312
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - recall: 0.5763
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5299
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - log_loss: 2.5695
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3075
2025-05-11 18:51:08,500 - src.experiments.src.core.model_trainer - INFO - 
New best model: RandomForest (AUC-ROC: 0.5373)
2025-05-11 18:51:08,500 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for RandomForest
2025-05-11 18:51:13,991 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for RandomForest
2025-05-11 18:51:13,991 - src.experiments.src.core.model_trainer - INFO - 
Training CatBoost...
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - 
CatBoost metrics:
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5678
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - f1: 0.5950
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - precision: 0.5806
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - recall: 0.6102
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5812
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.7740
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2768
2025-05-11 18:51:14,370 - src.experiments.src.core.model_trainer - INFO - 
New best model: CatBoost (AUC-ROC: 0.5678)
2025-05-11 18:51:14,370 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for CatBoost
2025-05-11 18:51:14,476 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for CatBoost
2025-05-11 18:51:14,477 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_5/model_comparison.csv
2025-05-11 18:51:14,477 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_5/model_comparison.json
2025-05-11 18:51:14,478 - src.experiments.src.utils.metrics - INFO - 
Model comparison:
2025-05-11 18:51:14,480 - src.experiments.src.utils.metrics - INFO - 
                     auc_roc        f1  precision    recall  accuracy  log_loss  brier_score
LogisticRegression  0.499708  0.575540   0.500000  0.677966  0.495726  1.056232     0.339842
RandomForest        0.537259  0.552846   0.531250  0.576271  0.529915  2.569468     0.307515
CatBoost            0.567797  0.595041   0.580645  0.610169  0.581197  0.774043     0.276788
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - 
LogisticRegression optimal threshold analysis:
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.030
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.674
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Precision: 0.509
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.513
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.340
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.333
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.640
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Precision: 0.527
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Recall: 0.814
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.538
2025-05-11 18:51:14,786 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.340
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - 
RandomForest optimal threshold analysis:
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.000
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.670
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Precision: 0.504
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.504
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.308
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.273
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.662
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Precision: 0.551
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Recall: 0.831
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.573
2025-05-11 18:51:15,086 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.308
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - 
CatBoost optimal threshold analysis:
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.141
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.675
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Precision: 0.518
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Recall: 0.966
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.530
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.277
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.495
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.608
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Precision: 0.576
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Recall: 0.644
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.581
2025-05-11 18:51:15,398 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.277
2025-05-11 18:51:15,399 - src.experiments.src.core.model_trainer - INFO - Saved LogisticRegression model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_5/checkpoints/window_5_logisticregression.joblib
2025-05-11 18:51:15,416 - src.experiments.src.core.model_trainer - INFO - Saved RandomForest model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_5/checkpoints/window_5_randomforest.joblib
2025-05-11 18:51:15,416 - src.experiments.src.core.model_trainer - INFO - Saved CatBoost model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_5/checkpoints/window_5_catboost.cbm
2025-05-11 18:51:15,418 - src.experiments.src.core.model_trainer - INFO - Saved best model (CatBoost) to production at /Users/ankamenskiy/SmartDota/models/catboost/window_5.cbm
2025-05-11 18:51:15,418 - root - INFO - 
Processing window 6/6
2025-05-11 18:51:15,419 - src.experiments.src.core.factory - INFO - Fitting pipeline on DataFrame with shape: (26464, 19)
2025-05-11 18:51:15,419 - src.experiments.src.core.factory - INFO - Fitting transformer: StarzDatasetConverter
2025-05-11 18:51:15,447 - src.experiments.src.core.factory - INFO - Fitting transformer: HeroStatsTransformer
2025-05-11 18:51:15,450 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loading heroes from: /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:51:15,454 - src.experiments.src.transformers.hero_stats_transformer - INFO - Loaded hero data from /Users/ankamenskiy/SmartDota/data/hero_stats.json
2025-05-11 18:51:15,454 - src.experiments.src.transformers.hero_stats_transformer - INFO - Number of heroes: 126
2025-05-11 18:51:15,454 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero statistics from match data...
2025-05-11 18:51:16,419 - src.experiments.src.transformers.hero_stats_transformer - INFO - Finished calculating hero statistics
2025-05-11 18:51:16,425 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerStatsTransformer
2025-05-11 18:51:16,428 - src.experiments.src.transformers.player_stats_transformer - INFO - Calculating player statistics from match data...
2025-05-11 18:51:18,878 - src.experiments.src.transformers.player_stats_transformer - INFO - Finished calculating player statistics
2025-05-11 18:51:18,884 - src.experiments.src.core.factory - INFO - Fitting transformer: PlayerHeroStatsTransformer
2025-05-11 18:51:18,887 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Calculating player-hero statistics from match data...
2025-05-11 18:51:23,860 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Finished calculating player-hero statistics
2025-05-11 18:51:23,866 - src.experiments.src.core.factory - INFO - Pipeline fitting completed
2025-05-11 18:51:23,866 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (26464, 19)
2025-05-11 18:51:23,866 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:51:23,869 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:51:23,872 - src.experiments.src.core.factory - INFO - Result df shape: (26464, 1)
2025-05-11 18:51:23,872 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:51:23,873 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   actualRank
0          62
1          62
2          71
3          72
4          54
2025-05-11 18:51:23,873 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:51:23,876 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:51:23,876 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:51:24,234 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:51:25,137 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:51:25,497 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:51:25,856 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:51:25,858 - src.experiments.src.core.factory - INFO - Result df shape: (26464, 7)
2025-05-11 18:51:25,859 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:51:25,861 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
0                   0.092851                0.090916                      0.499981               0.515125                  0.510353               0.533669                  0.503810
1                   0.105759                0.147914                      0.503143               0.504463                  0.493336               0.500985                  0.505841
2                   0.100748                0.114737                      0.498747               0.492248                  0.483039               0.491500                  0.467993
3                   0.108079                0.072733                      0.525690               0.507688                  0.511745               0.496878                  0.535714
4                   0.135920                0.091936                      0.503325               0.496270                  0.504265               0.485365                  0.509425
2025-05-11 18:51:25,861 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:51:25,864 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:52:06,336 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:52:06,345 - src.experiments.src.core.factory - INFO - Result df shape: (26464, 28)
2025-05-11 18:52:06,345 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:52:06,357 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  radiant_avg_hero_damage  ...  dire_avg_behavior  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
0           8.822222            8.716667            15.988889             225.463889            8.097222             30319.183333  ...           0.000000                    80.0                 0.4                  0.0                -1255034.2                      6.0
1           8.766667            6.200000            14.766667             154.733333           10.166667             21074.366667  ...           0.000000                    47.6                 0.2                  0.0                 -342750.0                      1.4
2          11.600000           11.000000            23.000000             308.600000            5.600000             37513.000000  ...           0.010526                    85.6                 0.0                  0.0                -2433459.2                     10.4
3           7.757143            8.723810            16.047619             262.597619            7.680952             30677.454762  ...           0.000000                   165.8                 1.0                  0.0                -2246007.6                     13.2
4          10.800000            9.400000            22.900000             189.500000            5.500000             36460.100000  ...           0.000000                    41.8                 0.6                  0.0                 -705874.2                      1.6

[5 rows x 28 columns]
2025-05-11 18:52:06,357 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:52:06,365 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:52:30,855 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:52:30,862 - src.experiments.src.core.factory - INFO - Result df shape: (26464, 12)
2025-05-11 18:52:30,862 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:52:30,868 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
   radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
0                    0.522222                         6.8                         0.233333                             1.84  ...                      1.000000                          1.00                         0.900000                             1.32
1                    0.766667                         2.0                         1.000000                             1.08  ...                      0.000000                          1.00                         0.000000                             1.00
2                    1.000000                         1.0                         1.000000                             1.00  ...                      0.111333                          2.00                         0.133333                             1.32
3                    0.552381                        11.2                         0.787238                             2.08  ...                      0.040000                          1.40                         0.086667                             1.48
4                    0.900000                         1.2                         1.000000                             1.00  ...                      0.120000                          1.24                         0.060000                             1.12

[5 rows x 12 columns]
2025-05-11 18:52:30,874 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:52:30,876 - src.experiments.src.core.factory - INFO - Transforming DataFrame with shape: (93, 19)
2025-05-11 18:52:30,876 - src.experiments.src.core.factory - INFO - Applying transformer: StarzDatasetConverter
2025-05-11 18:52:30,876 - src.experiments.src.transformers.starz_dataset_converter - INFO - Columns: match_id, radiant_win, start_time, end_time, actualRank, rank, radiant_team, dire_team, radiant_1, radiant_2, radiant_3, radiant_4, radiant_5, dire_1, dire_2, dire_3, dire_4, dire_5, pd_start_time
2025-05-11 18:52:30,876 - src.experiments.src.core.factory - INFO - Result df shape: (93, 1)
2025-05-11 18:52:30,876 - src.experiments.src.core.factory - INFO - Added features by StarzDatasetConverter: Index(['actualRank'], dtype='object')
2025-05-11 18:52:30,877 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       actualRank
26464          54
26465          53
26466          64
26467          61
26469          54
2025-05-11 18:52:30,877 - src.experiments.src.core.factory - INFO - Applying transformer: HeroStatsTransformer
2025-05-11 18:52:30,877 - src.experiments.src.transformers.hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:52:30,877 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero winrates within team...
2025-05-11 18:52:30,882 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero with hero winrates within team...
2025-05-11 18:52:30,898 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero versus hero winrates...
2025-05-11 18:52:30,901 - src.experiments.src.transformers.hero_stats_transformer - INFO - Calculating hero pickrates within team...
2025-05-11 18:52:30,904 - src.experiments.src.transformers.hero_stats_transformer - INFO - Added 7 hero statistics features
2025-05-11 18:52:30,905 - src.experiments.src.core.factory - INFO - Result df shape: (93, 7)
2025-05-11 18:52:30,905 - src.experiments.src.core.factory - INFO - Added features by HeroStatsTransformer: Index(['radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate',
       'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate',
       'radiant_avg_hero_winrate', 'dire_avg_hero_synergy',
       'radiant_avg_hero_synergy'],
      dtype='object')
2025-05-11 18:52:30,907 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_hero_pickrate  dire_avg_hero_pickrate  radiant_avg_vs_enemy_winrate  dire_avg_hero_winrate  radiant_avg_hero_winrate  dire_avg_hero_synergy  radiant_avg_hero_synergy
26464                   0.095919                0.090274                      0.494257               0.493875                  0.501626               0.487547                  0.467542
26465                   0.154686                0.124494                      0.497980               0.509176                  0.512624               0.512544                  0.530732
26466                   0.117375                0.093848                      0.499735               0.501402                  0.499049               0.467494                  0.512925
26467                   0.087016                0.155902                      0.525664               0.510908                  0.516470               0.516817                  0.538978
26469                   0.149615                0.065931                      0.506704               0.500730                  0.499516               0.490999                  0.508394
2025-05-11 18:52:30,907 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerStatsTransformer
2025-05-11 18:52:30,908 - src.experiments.src.transformers.player_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:52:31,095 - src.experiments.src.transformers.player_stats_transformer - INFO - Added 28 player statistics features
2025-05-11 18:52:31,096 - src.experiments.src.core.factory - INFO - Result df shape: (93, 28)
2025-05-11 18:52:31,096 - src.experiments.src.core.factory - INFO - Added features by PlayerStatsTransformer: Index(['radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists',
       'radiant_avg_last_hits', 'radiant_avg_denies',
       'radiant_avg_hero_damage', 'radiant_avg_hero_healing',
       'radiant_avg_role_match', 'radiant_avg_behavior',
       'radiant_avg_account_level', 'radiant_avg_dota_plus',
       'radiant_avg_smurf_flag', 'radiant_avg_time_since_last',
       'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths',
       'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies',
       'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match',
       'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus',
       'dire_avg_smurf_flag', 'dire_avg_time_since_last',
       'dire_avg_matches_played'],
      dtype='object')
2025-05-11 18:52:31,104 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_kills  radiant_avg_deaths  radiant_avg_assists  radiant_avg_last_hits  radiant_avg_denies  ...  dire_avg_account_level  dire_avg_dota_plus  dire_avg_smurf_flag  dire_avg_time_since_last  dire_avg_matches_played
26464          12.500000            3.500000            12.000000             232.000000           11.000000  ...                   169.0                 1.0                  0.0              1.218880e+06                      1.0
26465           5.777778            5.666667            18.333333             250.000000           15.888889  ...                   109.0                 0.0                  0.0              1.299803e+06                      3.0
26466           6.416667           10.541667            13.750000             245.125000            4.125000  ...                    99.6                 0.2                  0.0              1.322864e+05                      4.6
26467           3.000000            5.750000            15.500000             241.125000           10.125000  ...                     1.0                 1.0                  0.0              3.256250e+05                      1.0
26469           5.690909            7.057576            12.524242             188.387879           11.965152  ...                     0.0                 0.0                  0.0              0.000000e+00                      0.0

[5 rows x 28 columns]
2025-05-11 18:52:31,105 - src.experiments.src.core.factory - INFO - Applying transformer: PlayerHeroStatsTransformer
2025-05-11 18:52:31,105 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Starting feature transformation...
2025-05-11 18:52:31,187 - src.experiments.src.transformers.player_hero_stats_transformer - INFO - Added 12 player-hero statistics features
2025-05-11 18:52:31,187 - src.experiments.src.core.factory - INFO - Result df shape: (93, 12)
2025-05-11 18:52:31,187 - src.experiments.src.core.factory - INFO - Added features by PlayerHeroStatsTransformer: Index(['radiant_avg_player_winrate', 'radiant_avg_player_matches',
       'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches',
       'radiant_avg_player_vs_hero_winrate',
       'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate',
       'dire_avg_player_matches', 'dire_avg_player_hero_winrate',
       'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate',
       'dire_avg_player_vs_hero_matches'],
      dtype='object')
2025-05-11 18:52:31,191 - src.experiments.src.core.factory - INFO - First few rows of transformed data:
       radiant_avg_player_winrate  radiant_avg_player_matches  radiant_avg_player_hero_winrate  radiant_avg_player_hero_matches  ...  dire_avg_player_hero_winrate  dire_avg_player_hero_matches  dire_avg_player_vs_hero_winrate  dire_avg_player_vs_hero_matches
26464                    1.000000                    1.000000                         0.000000                         0.000000  ...                      0.000000                      0.000000                         0.000000                         0.000000
26465                    0.555556                    1.666667                         0.555556                         1.111111  ...                      0.833333                      1.333333                         1.000000                         1.333333
26466                    0.083333                    1.750000                         0.000000                         1.000000  ...                      0.875000                      1.250000                         0.854167                         1.125000
26467                    0.500000                    8.000000                         0.000000                         0.000000  ...                      1.000000                      1.000000                         0.000000                         0.000000
26469                    0.396970                   11.000000                         0.714141                         2.533333  ...                      0.000000                      0.000000                         0.000000                         0.000000

[5 rows x 12 columns]
2025-05-11 18:52:31,191 - src.experiments.src.core.factory - INFO - Final DataFrame columns: ['actualRank', 'radiant_avg_hero_pickrate', 'dire_avg_hero_pickrate', 'radiant_avg_vs_enemy_winrate', 'dire_avg_hero_winrate', 'radiant_avg_hero_winrate', 'dire_avg_hero_synergy', 'radiant_avg_hero_synergy', 'radiant_avg_kills', 'radiant_avg_deaths', 'radiant_avg_assists', 'radiant_avg_last_hits', 'radiant_avg_denies', 'radiant_avg_hero_damage', 'radiant_avg_hero_healing', 'radiant_avg_role_match', 'radiant_avg_behavior', 'radiant_avg_account_level', 'radiant_avg_dota_plus', 'radiant_avg_smurf_flag', 'radiant_avg_time_since_last', 'radiant_avg_matches_played', 'dire_avg_kills', 'dire_avg_deaths', 'dire_avg_assists', 'dire_avg_last_hits', 'dire_avg_denies', 'dire_avg_hero_damage', 'dire_avg_hero_healing', 'dire_avg_role_match', 'dire_avg_behavior', 'dire_avg_account_level', 'dire_avg_dota_plus', 'dire_avg_smurf_flag', 'dire_avg_time_since_last', 'dire_avg_matches_played', 'radiant_avg_player_winrate', 'radiant_avg_player_matches', 'radiant_avg_player_hero_winrate', 'radiant_avg_player_hero_matches', 'radiant_avg_player_vs_hero_winrate', 'radiant_avg_player_vs_hero_matches', 'dire_avg_player_winrate', 'dire_avg_player_matches', 'dire_avg_player_hero_winrate', 'dire_avg_player_hero_matches', 'dire_avg_player_vs_hero_winrate', 'dire_avg_player_vs_hero_matches']
2025-05-11 18:52:31,192 - src.experiments.src.core.model_trainer - INFO - Using parameter grid search: False
2025-05-11 18:52:31,192 - src.experiments.src.core.model_trainer - INFO - Using SHAP: True
2025-05-11 18:52:31,192 - src.experiments.src.core.model_trainer - INFO - Using feature scaling: False
2025-05-11 18:52:31,194 - src.experiments.src.core.model_trainer - INFO - 
Training and evaluating models...
2025-05-11 18:52:31,194 - src.experiments.src.core.model_trainer - INFO - 
Training LogisticRegression...
2025-05-11 18:52:32,171 - src.experiments.src.core.model_trainer - INFO - 
LogisticRegression metrics:
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.4576
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - f1: 0.6126
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - precision: 0.6415
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - recall: 0.5862
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5376
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - log_loss: 1.1070
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3373
2025-05-11 18:52:32,172 - src.experiments.src.core.model_trainer - INFO - 
New best model: LogisticRegression (AUC-ROC: 0.4576)
2025-05-11 18:52:32,172 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for LogisticRegression
2025-05-11 18:52:34,475 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for LogisticRegression
2025-05-11 18:52:34,475 - src.experiments.src.core.model_trainer - INFO - 
Training RandomForest...
2025-05-11 18:52:36,248 - src.experiments.src.core.model_trainer - INFO - 
RandomForest metrics:
2025-05-11 18:52:36,248 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5069
2025-05-11 18:52:36,248 - src.experiments.src.core.model_trainer - INFO - f1: 0.6126
2025-05-11 18:52:36,248 - src.experiments.src.core.model_trainer - INFO - precision: 0.6415
2025-05-11 18:52:36,248 - src.experiments.src.core.model_trainer - INFO - recall: 0.5862
2025-05-11 18:52:36,249 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5376
2025-05-11 18:52:36,249 - src.experiments.src.core.model_trainer - INFO - log_loss: 3.4020
2025-05-11 18:52:36,249 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.3164
2025-05-11 18:52:36,249 - src.experiments.src.core.model_trainer - INFO - 
New best model: RandomForest (AUC-ROC: 0.5069)
2025-05-11 18:52:36,249 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for RandomForest
2025-05-11 18:52:40,729 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for RandomForest
2025-05-11 18:52:40,729 - src.experiments.src.core.model_trainer - INFO - 
Training CatBoost...
2025-05-11 18:52:41,089 - src.experiments.src.core.model_trainer - INFO - 
CatBoost metrics:
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - auc_roc: 0.5424
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - f1: 0.6200
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - precision: 0.7381
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - recall: 0.5345
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - accuracy: 0.5914
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - log_loss: 0.7718
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - brier_score: 0.2798
2025-05-11 18:52:41,090 - src.experiments.src.core.model_trainer - INFO - 
New best model: CatBoost (AUC-ROC: 0.5424)
2025-05-11 18:52:41,090 - src.experiments.src.utils.feature_importance - INFO - 
Analyzing feature importance for CatBoost
2025-05-11 18:52:41,194 - src.experiments.src.utils.feature_importance - INFO - Saved feature importance statistics for CatBoost
2025-05-11 18:52:41,194 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_6/model_comparison.csv
2025-05-11 18:52:41,195 - src.experiments.src.utils.metrics - INFO - Saved model comparison to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_6/model_comparison.json
2025-05-11 18:52:41,195 - src.experiments.src.utils.metrics - INFO - 
Model comparison:
2025-05-11 18:52:41,197 - src.experiments.src.utils.metrics - INFO - 
                     auc_roc        f1  precision    recall  accuracy  log_loss  brier_score
LogisticRegression  0.457635  0.612613   0.641509  0.586207  0.537634  1.106984     0.337346
RandomForest        0.506897  0.612613   0.641509  0.586207  0.537634  3.401962     0.316403
CatBoost            0.542365  0.620000   0.738095  0.534483  0.591398  0.771766     0.279813
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - 
LogisticRegression optimal threshold analysis:
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.000
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.768
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Precision: 0.624
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.624
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.337
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.000
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.768
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Precision: 0.624
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.624
2025-05-11 18:52:41,494 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.337
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - 
RandomForest optimal threshold analysis:
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.000
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.768
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Precision: 0.624
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.624
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.316
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.000
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.768
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Precision: 0.624
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.624
2025-05-11 18:52:41,793 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.316
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - 
CatBoost optimal threshold analysis:
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - Optimal F1 threshold: 0.000
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - Metrics at optimal F1 threshold:
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.768
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - Precision: 0.624
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.624
2025-05-11 18:52:42,101 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.280
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - 
Optimal Accuracy threshold: 0.000
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - Metrics at optimal Accuracy threshold:
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - F1 Score: 0.768
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - Precision: 0.624
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - Recall: 1.000
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - Accuracy: 0.624
2025-05-11 18:52:42,102 - src.experiments.src.utils.metrics - INFO - Brier Score: 0.280
2025-05-11 18:52:42,102 - src.experiments.src.core.model_trainer - INFO - Saved LogisticRegression model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_6/checkpoints/window_6_logisticregression.joblib
2025-05-11 18:52:42,119 - src.experiments.src.core.model_trainer - INFO - Saved RandomForest model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_6/checkpoints/window_6_randomforest.joblib
2025-05-11 18:52:42,120 - src.experiments.src.core.model_trainer - INFO - Saved CatBoost model to /Users/ankamenskiy/SmartDota/src/experiments/src/runs/hero_ohe_3.78c_hero-stats_player-stats_playerHero-stats/2025.05.11-18.43.18/window_6/checkpoints/window_6_catboost.cbm
2025-05-11 18:52:42,121 - src.experiments.src.core.model_trainer - INFO - Saved best model (CatBoost) to production at /Users/ankamenskiy/SmartDota/models/catboost/window_6.cbm
2025-05-11 18:52:42,122 - root - INFO - 
Aggregated metrics across all windows:
2025-05-11 18:52:42,122 - root - INFO - 
LogisticRegression:
2025-05-11 18:52:42,122 - root - INFO - auc_roc: 0.5052
2025-05-11 18:52:42,122 - root - INFO - f1: 0.5856
2025-05-11 18:52:42,122 - root - INFO - precision: 0.5624
2025-05-11 18:52:42,122 - root - INFO - recall: 0.6230
2025-05-11 18:52:42,122 - root - INFO - accuracy: 0.5232
2025-05-11 18:52:42,122 - root - INFO - log_loss: 1.0201
2025-05-11 18:52:42,122 - root - INFO - brier_score: 0.3261
2025-05-11 18:52:42,122 - root - INFO - 
RandomForest:
2025-05-11 18:52:42,122 - root - INFO - auc_roc: 0.5354
2025-05-11 18:52:42,122 - root - INFO - f1: 0.5594
2025-05-11 18:52:42,122 - root - INFO - precision: 0.5752
2025-05-11 18:52:42,122 - root - INFO - recall: 0.5470
2025-05-11 18:52:42,122 - root - INFO - accuracy: 0.5282
2025-05-11 18:52:42,122 - root - INFO - log_loss: 2.5225
2025-05-11 18:52:42,122 - root - INFO - brier_score: 0.3031
2025-05-11 18:52:42,122 - root - INFO - 
CatBoost:
2025-05-11 18:52:42,122 - root - INFO - auc_roc: 0.5684
2025-05-11 18:52:42,122 - root - INFO - f1: 0.5906
2025-05-11 18:52:42,122 - root - INFO - precision: 0.6444
2025-05-11 18:52:42,122 - root - INFO - recall: 0.5490
2025-05-11 18:52:42,122 - root - INFO - accuracy: 0.5813
2025-05-11 18:52:42,122 - root - INFO - log_loss: 0.7276
2025-05-11 18:52:42,122 - root - INFO - brier_score: 0.2607
2025-05-11 18:52:42,122 - root - INFO - Time-based CV experiment completed successfully
